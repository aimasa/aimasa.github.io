---
title: 离散对数(Discrete logarithm)
copyright: true
date: 2019-02-27 14:49:07
categories:

- 离散对数
- 离散对数加密解密
tags:
- 离散对数加密解密

mathjax: true

---


设g为素数p的模循环群的[原根](https://aimasa.github.io/2019/02/26/%E5%8E%9F%E6%A0%B9/),那就意思是$\, g\, $的循环群的大小$\,=\, \Phi \left ( p \right )$,又因为$\,p\,$是素数，所以循环群大小为：$\, \left ( p\,-\,1 \right )$

对任意的a，计算： $b=g^{a}\ mod \ p$正推是很容易的，但是在只知道b而去求a的情况下，是非常难的。

因为a、b均为整数，不像实数那么“连续”，故称离散对数。

<!--more-->

[参考博文](https://blog.csdn.net/chen77716/article/details/7106485)

# 加密过程

## 加密方法1--标准Diffie-Hellman算法
A发送消息m（0<m<p）给B

A选取一个随机数$\, c\, $作为自己的私钥，然后这个随机数$\, 1\, < \, c\, < \, q\, $并且与$\, q\,-\,1\, $互质。接着计算$\,X\, = \, m^{c} \, mod \, q\,$，把X的值发送给A

B选取一个随机数$\, d\, $作为自己的私钥，这个随机数$\, 1\, < \, c\, < \, q\, $并且与$\, q\,-\,1\, $互质。然后拿着从A处得到的X值进行计算：$\, Y\, = \, X^{b}\, mod \, p\, $，得到Y值（其中可以把公式拆开来变成$ \, m^{cd} \, mod \, q\,$）并且把得到的Y发给A

A对从B处发来的Y进行计算：$\, Z\, =\, Y^{-c}\, $（可以把公式拆开得到：$ \, m^{cd\left ( -c \right )} \, mod \, q\,$，因为其中$\,cc^{-1}\,≡\,1(mod \,p-1)$，因为(c,p-1)=1，所以逆元素$c^{-1}$必存在。[参见群的定义](http://aimasa.github.io/2019/02/18/GaloisFields/)）

然后把Z值发回给B，让B根据这个值得到被加密的消息m。$z^{d^{-1}}=m^{dd^{-1}}\,mod\,p= m\,$因为m<p-1。$dd^{-1}$与前面$cc^{-1}$同理

## 加密方法2--T. ElGamal算法

因为比较容易懂，所以就不打出来了，直接贴截图把，也可以进[参考博文](https://blog.csdn.net/chen77716/article/details/7106485)直接看。

<center>{% qnimg 离散对数/fangfa1.png %}</center>
这里只需要进行两次通信，但是通信的内容和加密方法1比起来要多了一个群元素。

## 加密方法3--密钥交换

它就是相当于两边共享一个秘钥，然后用这个秘钥对信息进行加解密（对称加密）

<center>{% qnimg 离散对数/fangfa2.png %}</center>
这个方法比较容易被程序实现。

## 总结

这个加密算法难被破解的原因在于$b=g^{a}\ mod \ p$在这个公式中，只知道其中的b，p就算知道g，反推a也是非常的难，因为数据量之大，是没办法运算完成的。
